<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adicionar Saldo</title>
    <style>
        /* Estilo Global */
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background-color: #1a1a1a;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        /* Container Principal */
        .container {
            width: 90%;
            max-width: 600px;
            background-color: #222;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
            text-align: center;
        }

        /* Bot√µes de Valores Fixos */
        .buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            gap: 10px;
            margin-bottom: 20px;
        }

        .button {
            background-color: #333;
            color: white;
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            flex: 1 1 calc(30% - 10px);
            font-size: 14px;
            text-align: center;
            font-weight: bold;
            transition: background-color 0.3s, transform 0.2s;
        }

        .button:hover {
            background-color: #444;
            transform: scale(1.05);
        }

        .button span.gift {
            font-size: 12px;
            color: #ffd700;
            margin-left: 5px;
        }

        /* Mensagem de B√¥nus */
        .bonus-text {
            font-size: 14px;
            color: #00ff00;
            text-align: center;
            margin-bottom: 10px;
            font-weight: bold;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        /* Container de Montante */
        .montante-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            gap: 10px;
            margin-bottom: 20px;
        }

        .montante-container div {
            flex: 1 1 calc(50% - 10px);
            background-color: #333;
            border-radius: 5px;
            padding: 10px;
            text-align: center;
        }

        .montante-container div span {
            font-size: 12px;
            color: #888;
        }

        .montante-container div input {
            width: 100%;
            padding: 5px;
            background: none;
            border: none;
            color: white;
            font-size: 16px;
            text-align: center;
            outline: none;
        }

        /* Bot√£o de Pagamento */
        .pay-button {
            width: 100%;
            padding: 15px;
            background-color: #ff9800;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
            transition: background-color 0.3s, transform 0.2s;
        }

        .pay-button:hover {
            background-color: #ffa726;
            transform: scale(1.05);
        }

        /* Responsividade */
        @media (max-width: 600px) {
            .button {
                flex: 1 1 100%;
            }

            .montante-container div {
                flex: 1 1 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="buttons">
            <button class="button" onclick="adicionarSaldo(25)">25,00 R$ <span class="gift">üéÅ</span></button>
            <button class="button" onclick="adicionarSaldo(50)">50,00 R$ <span class="gift">üéÅ</span></button>
            <button class="button" onclick="adicionarSaldo(100)">100,00 R$ <span class="gift">üéÅ</span></button>
            <button class="button" onclick="adicionarSaldo(250)">250,00 R$ <span class="gift">üéÅ</span></button>
            <button class="button" onclick="adicionarSaldo(500)">500,00 R$ <span class="gift">üéÅ</span></button>
            <button class="button" onclick="adicionarSaldo(1000)">1000,00 R$ <span class="gift">üéÅ</span></button>
        </div>

        <div class="bonus-text" id="bonus-text" style="display: none;">
            Adicionando mais de 500,00 R$, voc√™ recebe 25% de b√¥nus!
        </div>

        <div class="montante-container">
            <div>
                <span>O SEU MONTANTE</span>
                <input type="text" id="input-value" placeholder="0,00 R$">
            </div>
            <div>
                <span>VOC√ä VAI RECEBER</span>
                <div id="receber-value">0,00 R$</div>
            </div>
        </div>

        <button class="pay-button" onclick="confirmarPagamento()">Pagar <span id="confirmar-valor">0,00 R$</span></button>
    </div>
<script type="module">
  import { db } from './firebase-config.js';
  import { doc, getDoc, updateDoc } from "firebase/firestore";

  const userId = "1"; // ID do documento no Firestore

  // Fun√ß√£o para buscar o saldo atual do Firestore
  async function buscarSaldo() {
    const docRef = doc(db, "usuarios", userId);
    const docSnap = await getDoc(docRef);

    if (docSnap.exists()) {
      return docSnap.data().saldo;
    } else {
      alert("Usu√°rio n√£o encontrado.");
      return 0;
    }
  }

  // Fun√ß√£o para atualizar o saldo no Firestore
  async function atualizarSaldo(valor) {
    const docRef = doc(db, "usuarios", userId);
    const saldoAtual = await buscarSaldo();
    const novoSaldo = saldoAtual + valor;

    await updateDoc(docRef, { saldo: novoSaldo });
    alert(`Pagamento confirmado! Seu novo saldo √©: ${novoSaldo.toFixed(2).replace('.', ',')} R$`);
    window.location.href = "index.html";
  }

  // Fun√ß√£o de confirma√ß√£o de pagamento
  async function confirmarPagamento() {
    const montanteInput = document.getElementById("input-value").value.replace(",", ".");
    const valor = parseFloat(montanteInput);

    if (isNaN(valor) || valor <= 0) {
      alert("Por favor, insira um valor v√°lido!");
      return;
    }

    let valorFinal = valor;

    if (valor > 500) {
      valorFinal += valor * 0.25; // Adiciona o b√¥nus de 25%
    }

    const confirmacao = confirm(`Voc√™ est√° prestes a adicionar ${valorFinal.toFixed(2).replace('.', ',')} R$. Deseja continuar?`);
    if (!confirmacao) return;

    await atualizarSaldo(valorFinal);
  }
</script>
</body>
</html>
